openapi: 3.0.3
info:
  title: Recipe Maps API
  version: 1.0.0
  description: Egyszerű API régiók és települések listázására.
servers:
  - url: http://localhost:3000
    description: Local dev server
paths:
  /api/maps/regions:
    get:
      parameters:
        - in: query
          name: regionId
          description: Opcionális szűrés. Több regionId megadható (?regionId=1&regionId=2) vagy vesszővel elválasztva (?regionId=1,2).
          required: false
          schema:
            type: array
            items:
              type: integer
              format: int32
          style: form
          explode: true
      tags: [Maps]
      summary: Régiók listázása (GeoJSON geometriával)
      description: Visszaadja az összes régiót név szerinti rendezéssel. A `geom` mező GeoJSON Geometry objektum.
      responses:
        '200':
          description: Sikeres lekérdezés
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RegionWithGeom'
              examples:
                sample:
                  value:
                    - id: 1
                      name: "Budapest"
                      geom:
                        type: Polygon
                        coordinates: [[[19.0,47.4],[19.3,47.4],[19.3,47.6],[19.0,47.6],[19.0,47.4]]]
                    - id: 2
                      name: "Bács-Kiskun"
                      geom: null
  /api/maps/settlements:
    get:
      tags: [Maps]
      summary: Települések listázása (GeoJSON geometriával)
      description: Visszaadja az összes települést név szerinti rendezéssel. A `geom` mező GeoJSON Geometry objektum.
      responses:
        '200':
          description: Sikeres lekérdezés
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SettlementWithGeom'
              examples:
                sample:
                  value:
                    - id: 101
                      name: "Budapest I. kerület"
                      regionid: 1
                      geom: null
                    - id: 102
                      name: "Kecskemét"
                      regionid: 2
                      geom:
                        type: Polygon
                        coordinates: [[[19.6,46.9],[19.8,46.9],[19.8,47.0],[19.6,47.0],[19.6,46.9]]]
components:
  schemas:
    Region:
      type: object
      properties:
        id:
          type: integer
          format: int32
          description: Régió azonosítója
        name:
          type: string
          nullable: true
          description: Régió neve
      required: [id]
    Geometry:
      type: object
      required: [type, coordinates]
      properties:
        type:
          type: string
          enum: [Point, LineString, Polygon, MultiPoint, MultiLineString, MultiPolygon]
        coordinates:
          description: GeoJSON koordináták
          oneOf:
            - type: array
              items:
                type: number
            - type: array
              items:
                type: array
                items:
                  type: number
            - type: array
              items:
                type: array
                items:
                  type: array
                  items:
                    type: number
    RegionWithGeom:
      allOf:
        - $ref: '#/components/schemas/Region'
        - type: object
          properties:
            geom:
              nullable: true
              $ref: '#/components/schemas/Geometry'
    Settlement:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: Település azonosítója
        name:
          type: string
          nullable: true
          description: Település neve
        regionid:
          type: integer
          format: int32
          nullable: true
          description: Régió azonosító
      required: [id]
    SettlementWithGeom:
      allOf:
        - $ref: '#/components/schemas/Settlement'
        - type: object
          properties:
            geom:
              nullable: true
              $ref: '#/components/schemas/Geometry'
