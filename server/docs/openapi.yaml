openapi: 3.0.3
info:
  title: Recipe Maps API
  version: 1.0.0
  description: Egyszeru API regiok es telepulesek listazasara.
servers:
  - url: http://localhost:3000
    description: Local dev server
paths:
  /api/maps/regions:
    get:
      tags: [Maps]
      summary: Regiok listazasa (GeoJSON geometriaval)
      description: Visszaadja az osszes regiot nev szerinti rendezessel. A `geom` mezo GeoJSON Geometry objektum.
      parameters:
        - in: query
          name: regionId
          description: Opcionális szures. Tobbszor megadhato (?regionId=1&regionId=2) vagy vesszovel elvalasztva (?regionId=1,2).
          required: false
          schema:
            type: array
            items:
              type: integer
              format: int32
          style: form
          explode: true
      responses:
        '200':
          description: Sikeres lekerdezes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RegionWithGeom'
  /api/maps/settlements:
    get:
      tags: [Maps]
      summary: Telepulesek listazasa (GeoJSON geometriaval)
      description: Visszaadja az osszes telepulest nev szerinti rendezessel. A `geom` mezo GeoJSON Geometry objektum.
      parameters:
        - in: query
          name: regionId
          description: Opcionális szures. Tobbszor megadhato (?regionId=1&regionId=2) vagy vesszovel elvalasztva (?regionId=1,2).
          required: false
          schema:
            type: array
            items:
              type: integer
              format: int32
          style: form
          explode: true
        - in: query
          name: settlementid
          description: Opcionális szures. Tobbszor megadhato (?settlementid=101&settlementid=102) vagy vesszovel elvalasztva (?settlementid=101,102).
          required: false
          schema:
            type: array
            items:
              type: integer
              format: int64
          style: form
          explode: true
      responses:
        '200':
          description: Sikeres lekerdezes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SettlementWithGeom'
  /api/recipes:
    get:
      tags: [Recipes]
      summary: Receptek listazasa
      description: Visszaadja az osszes receptet, opcionális szurokkel (ev, telepules, kategori a, regio). A valasz tartalmazza az osszes talalat szamat is.
      parameters:
        - in: query
          name: regionId
          required: false
          description: Opcionális szures regio(k) szerint. Tobbszor megadhato (?regionId=1&regionId=2) vagy vesszovel elvalasztva (?regionId=1,2). A regio szuro telepules ID-kke kerul kibontasra.
          schema:
            type: array
            items:
              type: integer
              format: int32
          style: form
          explode: true
        - in: query
          name: year
          required: false
          schema:
            type: array
            items:
              type: integer
              format: int32
          style: form
          explode: true
        - in: query
          name: settlementId
          required: false
          description: Opcionális szures telepules(ek) szerint.
          schema:
            type: array
            items:
              type: integer
              format: int64
          style: form
          explode: true
        - in: query
          name: categoryId
          required: false
          description: Opcionális szures kategori a(k) szerint.
          schema:
            type: array
            items:
              type: integer
              format: int32
          style: form
          explode: true
        - in: query
          name: ingredients
          required: false
          description: Opcionális szures hozzavalok szerint. Tobbszor megadhato (?ingredients=liszt&ingredients=tojas) vagy vesszovel elvalasztva (?ingredients=liszt,tojas).
          schema:
            type: array
            items:
              type: string
          style: form
          explode: true
        - in: query
          name: reverse
          required: false
          description: Ha true, az ingredients szurot invertalja, es olyan recepteket ad vissza, ahol nincs benne egyik megadott hozzavalo sem.
          schema:
            type: boolean
      responses:
        '200':
          description: Sikeres lekerdezes
          headers:
            X-Total-Count:
              description: Talalatok teljes szama a szurok figyelembevetelevel
              schema:
                type: integer
                format: int64
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RecipeListResponse'
  /api/recipes/categories:
    get:
      tags: [Recipes]
      summary: Kategoriak listazasa
      description: Visszaadja az osszes recept kategoriat nev szerinti rendezessel.
      responses:
        '200':
          description: Sikeres lekerdezes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Category'
components:
  schemas:
    Region:
      type: object
      properties:
        id:
          type: integer
          format: int32
          description: Regio azonositoja
        name:
          type: string
          nullable: true
          description: Regio neve
      required: [id]
    Geometry:
      type: object
      required: [type, coordinates]
      properties:
        type:
          type: string
          enum: [Point, LineString, Polygon, MultiPoint, MultiLineString, MultiPolygon]
        coordinates:
          description: GeoJSON koordinatak
          oneOf:
            - type: array
              items:
                type: number
            - type: array
              items:
                type: array
                items:
                  type: number
            - type: array
              items:
                type: array
                items:
                  type: array
                  items:
                    type: number
    RegionWithGeom:
      allOf:
        - $ref: '#/components/schemas/Region'
        - type: object
          properties:
            geom:
              nullable: true
              $ref: '#/components/schemas/Geometry'
    Settlement:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: Telepules azonositoja
        name:
          type: string
          nullable: true
          description: Telepules neve
        regionid:
          type: integer
          format: int32
          nullable: true
          description: Regio azonosito
      required: [id]
    SettlementWithGeom:
      allOf:
        - $ref: '#/components/schemas/Settlement'
        - type: object
          properties:
            geom:
              nullable: true
              $ref: '#/components/schemas/Geometry'
    RecipeListItem:
      type: object
      properties:
        url:
          type: string
        title:
          type: string
        year:
          type: integer
          format: int32
          nullable: true
        settlement_id:
          type: integer
          format: int64
          nullable: true
        category_id:
          type: integer
          format: int32
          nullable: true
    RecipeListResponse:
      type: object
      properties:
        count:
          type: integer
          format: int64
        items:
          type: array
          items:
            $ref: '#/components/schemas/RecipeListItem'
      required: [count, items]
    Category:
      type: object
      properties:
        id:
          type: integer
          format: int32
          description: Kategoria azonositoja
        name:
          type: string
          nullable: true
          description: Kategoria neve
      required: [id]
